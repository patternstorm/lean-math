import Core.NaturalDeduction
import Core.Universe
import Core.Sets

open Universe
open Sets

-- # Natural Numbers type
axiom NaturalNumber : Type
notation "â„•" => NaturalNumber

-- # Natural Numbers equality
axiom eq: â„• â†’ â„• â†’ Prop
notation:50 A:51 " =â‚™â‚â‚œ " B:51 => eq A B

axiom eq_refl: âˆ€ (n: â„•), n =â‚™â‚â‚œ n
axiom eq_poly_eq : âˆ€ (n: â„•), âˆ€ (m: â„•), n =â‚™â‚â‚œ m â†” n =â‚š m
-- NOTE, we should be able to derive these
axiom eq_sym: âˆ€ (n: â„•), âˆ€ (m: â„•), n =â‚™â‚â‚œ m â†’ m =â‚™â‚â‚œ n
axiom eq_trans: âˆ€ (nâ‚: â„•), âˆ€ (nâ‚‚: â„•), âˆ€ (nâ‚ƒ: â„•), nâ‚ =â‚™â‚â‚œ nâ‚‚ âˆ§ nâ‚‚ =â‚™â‚â‚œ nâ‚ƒ â†’ nâ‚ =â‚™â‚â‚œ nâ‚ƒ

-- # Natural Numbers constructors
axiom zero : â„•
notation "ğŸ¬" => zero

axiom succ : â„• â†’ â„•
prefix:max "ğšœ" => succ

-- ## Successor congruence
axiom succ_cong: âˆ€ (n: â„•), âˆ€ (m: â„•), (n =â‚™â‚â‚œ m) â†’ (ğšœ n) =â‚™â‚â‚œ (ğšœ m)

-- Natural Numbers induction
axiom induction : âˆ€ (S : Set â„•),
    ((ğŸ¬ âˆˆâ‚›â‚‘â‚œ S) âˆ§
    (âˆ€ (n: â„•), n âˆˆâ‚›â‚‘â‚œ S â†’ (ğšœ n) âˆˆâ‚›â‚‘â‚œ S)) â†’
    (âˆ€ (n: â„•), n âˆˆâ‚›â‚‘â‚œ S)

-- # Natural Numbers operations

-- ## Addition
axiom add : â„• â†’ â„• â†’ â„•
notation "(" n "+â‚™â‚â‚œ" m ")" => add n m

axiom add_zero_def : âˆ€ (n: â„•), (ğŸ¬ +â‚™â‚â‚œ n) =â‚™â‚â‚œ n
axiom add_succ_def : âˆ€ (n: â„•), âˆ€ (m: â„•), (ğšœ n +â‚™â‚â‚œ m) =â‚™â‚â‚œ ğšœ (n +â‚™â‚â‚œ m)

-- ## Addition concruence
axiom add_cong_right: âˆ€ (n: â„•), âˆ€ (nâ‚: â„•), âˆ€ (nâ‚‚: â„•), (nâ‚ =â‚™â‚â‚œ nâ‚‚) â†’ (n +â‚™â‚â‚œ nâ‚) =â‚™â‚â‚œ (n +â‚™â‚â‚œ nâ‚‚)
axiom add_cong_left: âˆ€ (n: â„•), âˆ€ (nâ‚: â„•), âˆ€ (nâ‚‚: â„•), (nâ‚ =â‚™â‚â‚œ nâ‚‚) â†’ (nâ‚ +â‚™â‚â‚œ n) =â‚™â‚â‚œ (nâ‚‚ +â‚™â‚â‚œ n)

-- # Theorems

-- ## Addition properties

theorem add_zero_right: âˆ€ (n: â„•), (n +â‚™â‚â‚œ ğŸ¬) =â‚™â‚â‚œ n := by
  have hâ‚: âˆ€ (n: â„•), (n +â‚™â‚â‚œ ğŸ¬) =â‚™â‚â‚œ n := by forall_intro
    let A: Set â„• := { n: â„• | (n +â‚™â‚â‚œ ğŸ¬) =â‚™â‚â‚œ n }
    variable (a: â„•)
    have hâ‚â‚: ğŸ¬ âˆˆâ‚›â‚‘â‚œ A := by
      have hâ‚â‚â‚: (ğŸ¬ +â‚™â‚â‚œ ğŸ¬) =â‚™â‚â‚œ ğŸ¬ := by forall_elim add_zero_def, ğŸ¬
      have hâ‚â‚â‚‚: âˆ€ (n: â„•), n âˆˆâ‚›â‚‘â‚œ A â†” A n := by forall_elim Sets.mem_def, A
      have hâ‚â‚â‚ƒ: ğŸ¬ âˆˆâ‚›â‚‘â‚œ A â†” A ğŸ¬ := by forall_elim hâ‚â‚â‚‚, ğŸ¬
      have hâ‚â‚â‚„: ğŸ¬ âˆˆâ‚›â‚‘â‚œ A := pcâ‚€.deductive_eq_r2l hâ‚â‚â‚ƒ hâ‚â‚â‚
      iterate hâ‚â‚â‚„
    have hâ‚â‚‚: âˆ€ (n: â„•), n âˆˆâ‚›â‚‘â‚œ A â†’ (ğšœ n) âˆˆâ‚›â‚‘â‚œ A := by forall_intro
      variable (a: â„•)
      assume(hâ‚â‚‚â‚: a âˆˆâ‚›â‚‘â‚œ A)
      have hâ‚â‚‚â‚‚: âˆ€ (n: â„•), n âˆˆâ‚›â‚‘â‚œ A â†” A n := by forall_elim Sets.mem_def, A
      have hâ‚â‚‚â‚ƒ: a âˆˆâ‚›â‚‘â‚œ A â†” A a := by forall_elim hâ‚â‚‚â‚‚, a
      have hâ‚â‚‚â‚„: (a +â‚™â‚â‚œ ğŸ¬) =â‚™â‚â‚œ a := pcâ‚€.deductive_eq_l2r hâ‚â‚‚â‚ƒ hâ‚â‚‚â‚
      have hâ‚â‚‚â‚…: (ğšœ a +â‚™â‚â‚œ ğŸ¬) =â‚™â‚â‚œ (ğšœ a) := by
        have hâ‚â‚‚â‚…â‚: (âˆ€ (n: â„•), âˆ€ (m: â„•), (ğšœ n +â‚™â‚â‚œ m) =â‚™â‚â‚œ ğšœ (n +â‚™â‚â‚œ m)) â†” (âˆ€ (m: â„•), âˆ€ (n: â„•), (ğšœ n +â‚™â‚â‚œ m) =â‚™â‚â‚œ ğšœ (n +â‚™â‚â‚œ m)) := pcâ‚.forall_comm
        have hâ‚â‚‚â‚…â‚‚: âˆ€ (m: â„•), âˆ€ (n: â„•), (ğšœ n +â‚™â‚â‚œ m) =â‚™â‚â‚œ ğšœ (n +â‚™â‚â‚œ m) := pcâ‚€.deductive_eq_l2r hâ‚â‚‚â‚…â‚ add_succ_def
        have hâ‚â‚‚â‚…â‚ƒ: âˆ€ (n: â„•), (ğšœ n +â‚™â‚â‚œ ğŸ¬) =â‚™â‚â‚œ ğšœ (n +â‚™â‚â‚œ ğŸ¬) := by forall_elim hâ‚â‚‚â‚…â‚‚, ğŸ¬
        have hâ‚â‚‚â‚…â‚„: (ğšœ a +â‚™â‚â‚œ ğŸ¬) =â‚™â‚â‚œ ğšœ (a +â‚™â‚â‚œ ğŸ¬) := by forall_elim hâ‚â‚‚â‚…â‚ƒ, a
        have hâ‚â‚‚â‚…â‚…: ğšœ (a +â‚™â‚â‚œ ğŸ¬) =â‚™â‚â‚œ ğšœ a := by
          have hâ‚â‚‚â‚…â‚…â‚: âˆ€ (m: â„•), ((a +â‚™â‚â‚œ ğŸ¬) =â‚™â‚â‚œ m) â†’ (ğšœ (a +â‚™â‚â‚œ ğŸ¬)) =â‚™â‚â‚œ (ğšœ m) := by forall_elim succ_cong, (a +â‚™â‚â‚œ ğŸ¬)
          have hâ‚â‚‚â‚…â‚…â‚‚: ((a +â‚™â‚â‚œ ğŸ¬) =â‚™â‚â‚œ a) â†’ (ğšœ (a +â‚™â‚â‚œ ğŸ¬)) =â‚™â‚â‚œ (ğšœ a) := by forall_elim hâ‚â‚‚â‚…â‚…â‚, a
          modus_ponens hâ‚â‚‚â‚…â‚…â‚‚, hâ‚â‚‚â‚„
        have hâ‚â‚‚â‚…â‚†: (ğšœ a +â‚™â‚â‚œ ğŸ¬) =â‚™â‚â‚œ (ğšœ a) := by
          have hâ‚â‚‚â‚…â‚†â‚: âˆ€ (nâ‚‚: â„•), âˆ€ (nâ‚ƒ: â„•), (ğšœ a +â‚™â‚â‚œ ğŸ¬) =â‚™â‚â‚œ nâ‚‚ âˆ§ nâ‚‚ =â‚™â‚â‚œ nâ‚ƒ â†’ (ğšœ a +â‚™â‚â‚œ ğŸ¬) =â‚™â‚â‚œ nâ‚ƒ := by forall_elim eq_trans, (ğšœ a +â‚™â‚â‚œ ğŸ¬)
          have hâ‚â‚‚â‚…â‚†â‚‚: âˆ€ (nâ‚ƒ: â„•), (ğšœ a +â‚™â‚â‚œ ğŸ¬) =â‚™â‚â‚œ (ğšœ (a +â‚™â‚â‚œ ğŸ¬)) âˆ§ (ğšœ (a +â‚™â‚â‚œ ğŸ¬)) =â‚™â‚â‚œ nâ‚ƒ â†’ (ğšœ a +â‚™â‚â‚œ ğŸ¬) =â‚™â‚â‚œ nâ‚ƒ := by forall_elim hâ‚â‚‚â‚…â‚†â‚, (ğšœ (a +â‚™â‚â‚œ ğŸ¬))
          have hâ‚â‚‚â‚…â‚†â‚ƒ: (ğšœ a +â‚™â‚â‚œ ğŸ¬) =â‚™â‚â‚œ (ğšœ (a +â‚™â‚â‚œ ğŸ¬)) âˆ§ (ğšœ (a +â‚™â‚â‚œ ğŸ¬)) =â‚™â‚â‚œ (ğšœ a) â†’ (ğšœ a +â‚™â‚â‚œ ğŸ¬) =â‚™â‚â‚œ (ğšœ a) := by forall_elim hâ‚â‚‚â‚…â‚†â‚‚, (ğšœ a)
          have hâ‚â‚‚â‚…â‚†â‚„: (ğšœ a +â‚™â‚â‚œ ğŸ¬) =â‚™â‚â‚œ (ğšœ (a +â‚™â‚â‚œ ğŸ¬)) âˆ§ (ğšœ (a +â‚™â‚â‚œ ğŸ¬)) =â‚™â‚â‚œ (ğšœ a) := by and_intro hâ‚â‚‚â‚…â‚„, hâ‚â‚‚â‚…â‚…
          modus_ponens hâ‚â‚‚â‚…â‚†â‚ƒ, hâ‚â‚‚â‚…â‚†â‚„
        iterate hâ‚â‚‚â‚…â‚†
      have hâ‚â‚‚â‚†: (ğšœ a) âˆˆâ‚›â‚‘â‚œ A â†” A (ğšœ a) := by forall_elim hâ‚â‚‚â‚‚, ğšœ a
      have hâ‚â‚‚â‚‡: (ğšœ a) âˆˆâ‚›â‚‘â‚œ A := pcâ‚€.deductive_eq_r2l hâ‚â‚‚â‚† hâ‚â‚‚â‚…
      iterate hâ‚â‚‚â‚‡
    have hâ‚â‚ƒ: (ğŸ¬ âˆˆâ‚›â‚‘â‚œ A) âˆ§ (âˆ€ (n: â„•), n âˆˆâ‚›â‚‘â‚œ A â†’ (ğšœ n) âˆˆâ‚›â‚‘â‚œ A) := by and_intro hâ‚â‚, hâ‚â‚‚
    have hâ‚â‚„: (ğŸ¬ âˆˆâ‚›â‚‘â‚œ A) âˆ§ (âˆ€ (n: â„•), n âˆˆâ‚›â‚‘â‚œ A â†’ (ğšœ n) âˆˆâ‚›â‚‘â‚œ A) â†’ (âˆ€ (n: â„•), n âˆˆâ‚›â‚‘â‚œ A) := by forall_elim induction, A
    have hâ‚â‚…: âˆ€ (n: â„•), n âˆˆâ‚›â‚‘â‚œ A := by modus_ponens hâ‚â‚„, hâ‚â‚ƒ
    have hâ‚â‚†: a âˆˆâ‚›â‚‘â‚œ A := by forall_elim hâ‚â‚…, a
    have hâ‚â‚‡: âˆ€ (n: â„•), n âˆˆâ‚›â‚‘â‚œ A â†” A n := by forall_elim Sets.mem_def, A
    have hâ‚â‚ˆ: a âˆˆâ‚›â‚‘â‚œ A â†” A a := by forall_elim hâ‚â‚‡, a
    have hâ‚â‚‰: (a +â‚™â‚â‚œ ğŸ¬) =â‚™â‚â‚œ a := pcâ‚€.deductive_eq_l2r hâ‚â‚ˆ hâ‚â‚†
    iterate hâ‚â‚‰
  iterate hâ‚

theorem add_suc_right: âˆ€ (n: â„•), âˆ€ (m: â„•), (n +â‚™â‚â‚œ ğšœ m) =â‚™â‚â‚œ ğšœ (n +â‚™â‚â‚œ m) := by
  let A := { n: â„• | âˆ€ (m : â„•), (n +â‚™â‚â‚œ ğšœ m) =â‚™â‚â‚œ ğšœ (n +â‚™â‚â‚œ m) }
  have hâ‚€: âˆ€ (n: â„•), n âˆˆâ‚›â‚‘â‚œ A â†” A n := by forall_elim Sets.mem_def, A
  have hâ‚: ğŸ¬ âˆˆâ‚›â‚‘â‚œ A := by
    have hâ‚â‚: âˆ€ (m: â„•), (ğŸ¬ +â‚™â‚â‚œ ğšœ m) =â‚™â‚â‚œ ğšœ m := by forall_intro
      variable(a: â„•)
      have hâ‚â‚â‚: (ğŸ¬ +â‚™â‚â‚œ ğšœ a) =â‚™â‚â‚œ ğšœ a := by forall_elim add_zero_def, (ğšœ a)
      iterate hâ‚â‚â‚
    have hâ‚â‚‚: âˆ€ (m: â„•), ğšœ (ğŸ¬ +â‚™â‚â‚œ m) =â‚™â‚â‚œ ğšœ m := by forall_intro
      variable(a: â„•)
      have hâ‚â‚‚â‚: (ğŸ¬ +â‚™â‚â‚œ a) =â‚™â‚â‚œ a := by forall_elim add_zero_def, a
      have hâ‚â‚‚â‚‚: âˆ€ (m: â„•), (ğŸ¬ +â‚™â‚â‚œ a) =â‚™â‚â‚œ m â†’ ğšœ (ğŸ¬ +â‚™â‚â‚œ a) =â‚™â‚â‚œ ğšœ m := by forall_elim succ_cong, (ğŸ¬ +â‚™â‚â‚œ a)
      have hâ‚â‚‚â‚ƒ: (ğŸ¬ +â‚™â‚â‚œ a) =â‚™â‚â‚œ a â†’ ğšœ (ğŸ¬ +â‚™â‚â‚œ a) =â‚™â‚â‚œ ğšœ a := by forall_elim hâ‚â‚‚â‚‚, a
      modus_ponens hâ‚â‚‚â‚ƒ, hâ‚â‚‚â‚
    have hâ‚â‚ƒ: âˆ€ (m: â„•), (ğŸ¬ +â‚™â‚â‚œ ğšœ m) =â‚™â‚â‚œ ğšœ (ğŸ¬ +â‚™â‚â‚œ m) := by forall_intro
      variable(a: â„•)
      have hâ‚â‚ƒâ‚: (ğŸ¬ +â‚™â‚â‚œ ğšœ a) =â‚™â‚â‚œ ğšœ a := by forall_elim hâ‚â‚, a
      have hâ‚â‚ƒâ‚‚: ğšœ (ğŸ¬ +â‚™â‚â‚œ a) =â‚™â‚â‚œ ğšœ a := by forall_elim hâ‚â‚‚, a
      have hâ‚â‚ƒâ‚ƒ: âˆ€ (m: â„•), (ğšœ (ğŸ¬ +â‚™â‚â‚œ a)) =â‚™â‚â‚œ m â†’ m =â‚™â‚â‚œ ğšœ (ğŸ¬ +â‚™â‚â‚œ a) := by forall_elim eq_sym, (ğšœ (ğŸ¬ +â‚™â‚â‚œ a))
      have hâ‚â‚ƒâ‚„: (ğšœ (ğŸ¬ +â‚™â‚â‚œ a)) =â‚™â‚â‚œ ğšœ a â†’ ğšœ a =â‚™â‚â‚œ ğšœ (ğŸ¬ +â‚™â‚â‚œ a) := by forall_elim hâ‚â‚ƒâ‚ƒ, (ğšœ a)
      have hâ‚â‚ƒâ‚…: ğšœ a =â‚™â‚â‚œ ğšœ (ğŸ¬ +â‚™â‚â‚œ a) := by modus_ponens hâ‚â‚ƒâ‚„, hâ‚â‚ƒâ‚‚
      have hâ‚â‚ƒâ‚†: âˆ€ (nâ‚‚: â„•), âˆ€ (nâ‚ƒ: â„•), (ğŸ¬ +â‚™â‚â‚œ ğšœ a) =â‚™â‚â‚œ nâ‚‚ âˆ§ nâ‚‚ =â‚™â‚â‚œ nâ‚ƒ â†’ (ğŸ¬ +â‚™â‚â‚œ ğšœ a) =â‚™â‚â‚œ nâ‚ƒ := by forall_elim eq_trans, (ğŸ¬ +â‚™â‚â‚œ ğšœ a)
      have hâ‚â‚ƒâ‚‡: âˆ€ (nâ‚ƒ: â„•), (ğŸ¬ +â‚™â‚â‚œ ğšœ a) =â‚™â‚â‚œ (ğšœ a) âˆ§ (ğšœ a) =â‚™â‚â‚œ nâ‚ƒ â†’ (ğŸ¬ +â‚™â‚â‚œ ğšœ a) =â‚™â‚â‚œ nâ‚ƒ := by forall_elim hâ‚â‚ƒâ‚†, (ğšœ a)
      have hâ‚â‚ƒâ‚ˆ: (ğŸ¬ +â‚™â‚â‚œ ğšœ a) =â‚™â‚â‚œ (ğšœ a) âˆ§ (ğšœ a) =â‚™â‚â‚œ (ğšœ (ğŸ¬ +â‚™â‚â‚œ a)) â†’ (ğŸ¬ +â‚™â‚â‚œ ğšœ a) =â‚™â‚â‚œ (ğšœ (ğŸ¬ +â‚™â‚â‚œ a)) := by forall_elim hâ‚â‚ƒâ‚‡, (ğšœ (ğŸ¬ +â‚™â‚â‚œ a))
      have hâ‚â‚ƒâ‚‰: (ğŸ¬ +â‚™â‚â‚œ ğšœ a) =â‚™â‚â‚œ (ğšœ a) âˆ§ (ğšœ a) =â‚™â‚â‚œ (ğšœ (ğŸ¬ +â‚™â‚â‚œ a)) := by and_intro hâ‚â‚ƒâ‚, hâ‚â‚ƒâ‚…
      modus_ponens hâ‚â‚ƒâ‚ˆ, hâ‚â‚ƒâ‚‰
    have hâ‚â‚„: ğŸ¬ âˆˆâ‚›â‚‘â‚œ A â†” A ğŸ¬ := by forall_elim hâ‚€, ğŸ¬
    have hâ‚â‚…: ğŸ¬ âˆˆâ‚›â‚‘â‚œ A := pcâ‚€.deductive_eq_r2l hâ‚â‚„ hâ‚â‚ƒ
    iterate hâ‚â‚…
  have hâ‚‚: âˆ€ (n: â„•), n âˆˆâ‚›â‚‘â‚œ A â†’ (ğšœ n) âˆˆâ‚›â‚‘â‚œ A := by forall_intro
    variable(a: â„•)
    assume(hâ‚‚â‚: a âˆˆâ‚›â‚‘â‚œ A)
    have hâ‚‚â‚‚: a âˆˆâ‚›â‚‘â‚œ A â†” A a := by forall_elim hâ‚€, a
    have hâ‚‚â‚ƒ: âˆ€ (m: â„•), (a +â‚™â‚â‚œ ğšœ m) =â‚™â‚â‚œ ğšœ (a +â‚™â‚â‚œ m) := pcâ‚€.deductive_eq_l2r hâ‚‚â‚‚ hâ‚‚â‚
    have hâ‚‚â‚„: âˆ€ (m: â„•), (ğšœ a +â‚™â‚â‚œ ğšœ m) =â‚™â‚â‚œ ğšœ (ğšœ a +â‚™â‚â‚œ m) := by forall_intro
      variable(b: â„•)
      have hâ‚‚â‚„â‚: (a +â‚™â‚â‚œ ğšœ b) =â‚™â‚â‚œ ğšœ (a +â‚™â‚â‚œ b) := by forall_elim hâ‚‚â‚ƒ, b
      have hâ‚‚â‚„â‚‚: âˆ€ (m: â„•), (ğšœ a +â‚™â‚â‚œ m) =â‚™â‚â‚œ ğšœ (a +â‚™â‚â‚œ m) := by forall_elim add_succ_def, a
      have hâ‚‚â‚„â‚ƒ: (ğšœ a +â‚™â‚â‚œ ğšœ b) =â‚™â‚â‚œ ğšœ (a +â‚™â‚â‚œ ğšœ b) := by forall_elim hâ‚‚â‚„â‚‚, (ğšœ b)
      have hâ‚‚â‚„â‚„: âˆ€ (m: â„•), (ğšœ a +â‚™â‚â‚œ m) =â‚™â‚â‚œ ğšœ (a +â‚™â‚â‚œ m) := by forall_elim add_succ_def, a
      have hâ‚‚â‚„â‚…: (ğšœ a +â‚™â‚â‚œ b) =â‚™â‚â‚œ ğšœ (a +â‚™â‚â‚œ b) := by forall_elim hâ‚‚â‚„â‚„, b
      have hâ‚‚â‚„â‚†: âˆ€ (m: â„•), (ğšœ a +â‚™â‚â‚œ b) =â‚™â‚â‚œ m â†’ m =â‚™â‚â‚œ (ğšœ a +â‚™â‚â‚œ b) := by forall_elim eq_sym, (ğšœ a +â‚™â‚â‚œ b)
      have hâ‚‚â‚„â‚‡: (ğšœ a +â‚™â‚â‚œ b) =â‚™â‚â‚œ (ğšœ (a +â‚™â‚â‚œ b)) â†’ (ğšœ (a +â‚™â‚â‚œ b)) =â‚™â‚â‚œ (ğšœ a +â‚™â‚â‚œ b) := by forall_elim hâ‚‚â‚„â‚†, (ğšœ (a +â‚™â‚â‚œ b))
      have hâ‚‚â‚„â‚ˆ: (ğšœ (a +â‚™â‚â‚œ b)) =â‚™â‚â‚œ (ğšœ a +â‚™â‚â‚œ b) := by modus_ponens hâ‚‚â‚„â‚‡, hâ‚‚â‚„â‚…
      have hâ‚‚â‚„â‚‰: âˆ€ (nâ‚‚: â„•), âˆ€ (nâ‚ƒ: â„•), (a +â‚™â‚â‚œ ğšœ b) =â‚™â‚â‚œ nâ‚‚ âˆ§ nâ‚‚ =â‚™â‚â‚œ nâ‚ƒ â†’ (a +â‚™â‚â‚œ ğšœ b) =â‚™â‚â‚œ nâ‚ƒ := by forall_elim eq_trans, (a +â‚™â‚â‚œ ğšœ b)
      have hâ‚‚â‚„â‚â‚€: âˆ€ (nâ‚ƒ: â„•), (a +â‚™â‚â‚œ ğšœ b) =â‚™â‚â‚œ (ğšœ (a +â‚™â‚â‚œ b)) âˆ§ (ğšœ (a +â‚™â‚â‚œ b)) =â‚™â‚â‚œ nâ‚ƒ â†’ (a +â‚™â‚â‚œ ğšœ b) =â‚™â‚â‚œ nâ‚ƒ := by forall_elim hâ‚‚â‚„â‚‰, (ğšœ (a +â‚™â‚â‚œ b))
      have hâ‚‚â‚„â‚â‚: (a +â‚™â‚â‚œ ğšœ b) =â‚™â‚â‚œ (ğšœ (a +â‚™â‚â‚œ b)) âˆ§ (ğšœ (a +â‚™â‚â‚œ b)) =â‚™â‚â‚œ (ğšœ a +â‚™â‚â‚œ b) â†’ (a +â‚™â‚â‚œ ğšœ b) =â‚™â‚â‚œ (ğšœ a +â‚™â‚â‚œ b) := by forall_elim hâ‚‚â‚„â‚â‚€, (ğšœ a +â‚™â‚â‚œ b)
      have hâ‚‚â‚„â‚â‚‚: (a +â‚™â‚â‚œ ğšœ b) =â‚™â‚â‚œ (ğšœ (a +â‚™â‚â‚œ b)) âˆ§ (ğšœ (a +â‚™â‚â‚œ b)) =â‚™â‚â‚œ (ğšœ a +â‚™â‚â‚œ b) := by and_intro hâ‚‚â‚„â‚, hâ‚‚â‚„â‚ˆ
      have hâ‚‚â‚„â‚â‚ƒ: (a +â‚™â‚â‚œ ğšœ b) =â‚™â‚â‚œ (ğšœ a +â‚™â‚â‚œ b) := by modus_ponens hâ‚‚â‚„â‚â‚, hâ‚‚â‚„â‚â‚‚
      have hâ‚‚â‚„â‚â‚„: âˆ€ (m: â„•), ((a +â‚™â‚â‚œ ğšœ b) =â‚™â‚â‚œ m) â†’ (ğšœ (a +â‚™â‚â‚œ ğšœ b)) =â‚™â‚â‚œ (ğšœ m) := by forall_elim succ_cong, (a +â‚™â‚â‚œ ğšœ b)
      have hâ‚‚â‚„â‚â‚…: ((a +â‚™â‚â‚œ ğšœ b) =â‚™â‚â‚œ (ğšœ a +â‚™â‚â‚œ b) â†’ (ğšœ (a +â‚™â‚â‚œ ğšœ b)) =â‚™â‚â‚œ (ğšœ (ğšœ a +â‚™â‚â‚œ b))) := by forall_elim hâ‚‚â‚„â‚â‚„, (ğšœ a +â‚™â‚â‚œ b)
      have hâ‚‚â‚„â‚â‚†: (ğšœ (a +â‚™â‚â‚œ ğšœ b)) =â‚™â‚â‚œ (ğšœ (ğšœ a +â‚™â‚â‚œ b)) := by  modus_ponens hâ‚‚â‚„â‚â‚…, hâ‚‚â‚„â‚â‚ƒ
      have hâ‚‚â‚„â‚â‚‡: âˆ€ (nâ‚‚: â„•), âˆ€ (nâ‚ƒ: â„•), (ğšœ a +â‚™â‚â‚œ ğšœ b) =â‚™â‚â‚œ nâ‚‚ âˆ§ nâ‚‚ =â‚™â‚â‚œ nâ‚ƒ â†’ (ğšœ a +â‚™â‚â‚œ ğšœ b) =â‚™â‚â‚œ nâ‚ƒ := by forall_elim eq_trans, (ğšœ a +â‚™â‚â‚œ ğšœ b)
      have hâ‚‚â‚„â‚â‚ˆ: âˆ€ (nâ‚ƒ: â„•), (ğšœ a +â‚™â‚â‚œ ğšœ b) =â‚™â‚â‚œ (ğšœ (a +â‚™â‚â‚œ ğšœ b)) âˆ§ (ğšœ (a +â‚™â‚â‚œ ğšœ b)) =â‚™â‚â‚œ nâ‚ƒ â†’ (ğšœ a +â‚™â‚â‚œ ğšœ b) =â‚™â‚â‚œ nâ‚ƒ := by forall_elim hâ‚‚â‚„â‚â‚‡, (ğšœ (a +â‚™â‚â‚œ ğšœ b))
      have hâ‚‚â‚„â‚â‚‰: (ğšœ a +â‚™â‚â‚œ ğšœ b) =â‚™â‚â‚œ (ğšœ (a +â‚™â‚â‚œ ğšœ b)) âˆ§ (ğšœ (a +â‚™â‚â‚œ ğšœ b)) =â‚™â‚â‚œ (ğšœ (ğšœ a +â‚™â‚â‚œ b)) â†’ (ğšœ a +â‚™â‚â‚œ ğšœ b) =â‚™â‚â‚œ (ğšœ (ğšœ a +â‚™â‚â‚œ b)) := by forall_elim hâ‚‚â‚„â‚â‚ˆ, (ğšœ (ğšœ a +â‚™â‚â‚œ b))
      have hâ‚‚â‚„â‚â‚â‚€: (ğšœ a +â‚™â‚â‚œ ğšœ b) =â‚™â‚â‚œ (ğšœ (a +â‚™â‚â‚œ ğšœ b)) âˆ§ (ğšœ (a +â‚™â‚â‚œ ğšœ b)) =â‚™â‚â‚œ (ğšœ (ğšœ a +â‚™â‚â‚œ b)) := by and_intro hâ‚‚â‚„â‚ƒ, hâ‚‚â‚„â‚â‚†
      have hâ‚‚â‚„â‚â‚â‚: (ğšœ a +â‚™â‚â‚œ ğšœ b) =â‚™â‚â‚œ (ğšœ (ğšœ a +â‚™â‚â‚œ b)) := by modus_ponens hâ‚‚â‚„â‚â‚‰, hâ‚‚â‚„â‚â‚â‚€
      iterate hâ‚‚â‚„â‚â‚â‚
    have hâ‚‚â‚…: ğšœ a âˆˆâ‚›â‚‘â‚œ A â†” A (ğšœ a) := by forall_elim hâ‚€, (ğšœ a)
    have hâ‚‚â‚†: ğšœ a âˆˆâ‚›â‚‘â‚œ A := pcâ‚€.deductive_eq_r2l hâ‚‚â‚… hâ‚‚â‚„
    iterate hâ‚‚â‚†
  have hâ‚ƒ: ((ğŸ¬ âˆˆâ‚›â‚‘â‚œ A) âˆ§ (âˆ€ (n: â„•), n âˆˆâ‚›â‚‘â‚œ A â†’ (ğšœ n) âˆˆâ‚›â‚‘â‚œ A)) â†’ (âˆ€ (n: â„•), n âˆˆâ‚›â‚‘â‚œ A) := by forall_elim induction, A
  have hâ‚„: ğŸ¬ âˆˆâ‚›â‚‘â‚œ A âˆ§ (âˆ€ (n: â„•), n âˆˆâ‚›â‚‘â‚œ A â†’ (ğšœ n) âˆˆâ‚›â‚‘â‚œ A) := by and_intro hâ‚, hâ‚‚
  have hâ‚…: âˆ€ (n: â„•), n âˆˆâ‚›â‚‘â‚œ A := by modus_ponens hâ‚ƒ, hâ‚„
  have hâ‚†: âˆ€ (n: â„•), âˆ€ (m: â„•), (n +â‚™â‚â‚œ ğšœ m) =â‚™â‚â‚œ ğšœ (n +â‚™â‚â‚œ m) := by forall_intro
    variable(a: â„•)
    have hâ‚†â‚: a âˆˆâ‚›â‚‘â‚œ A := by forall_elim hâ‚…, a
    have hâ‚†â‚‚: a âˆˆâ‚›â‚‘â‚œ A â†” A a := by forall_elim hâ‚€, a
    have hâ‚†â‚ƒ: âˆ€ (m: â„•), (a +â‚™â‚â‚œ ğšœ m) =â‚™â‚â‚œ ğšœ (a +â‚™â‚â‚œ m) := pcâ‚€.deductive_eq_l2r hâ‚†â‚‚ hâ‚†â‚
    iterate hâ‚†â‚ƒ
  iterate hâ‚†

-- ### Addition commutativity
theorem add_commutativity: âˆ€ (n: â„•), âˆ€ (m: â„•), (n +â‚™â‚â‚œ m) =â‚™â‚â‚œ (m +â‚™â‚â‚œ n) := by
  have hâ‚: âˆ€ (n: â„•), âˆ€ (m: â„•), (n +â‚™â‚â‚œ m) =â‚™â‚â‚œ (m +â‚™â‚â‚œ n) := by forall_intro
    let A: Set â„• := { n: â„• | âˆ€ (m : â„•), (n +â‚™â‚â‚œ m) =â‚™â‚â‚œ (m +â‚™â‚â‚œ n) }
    have hâ‚â‚: ğŸ¬ âˆˆâ‚›â‚‘â‚œ A := by
      have hâ‚â‚â‚: âˆ€ (m : â„•), (ğŸ¬ +â‚™â‚â‚œ m) =â‚™â‚â‚œ (m +â‚™â‚â‚œ ğŸ¬) := by forall_intro
        variable(a: â„•)
        have hâ‚â‚â‚â‚: (ğŸ¬ +â‚™â‚â‚œ a) =â‚™â‚â‚œ a := by forall_elim add_zero_def, a
        have hâ‚â‚â‚â‚‚: (a +â‚™â‚â‚œ ğŸ¬) =â‚™â‚â‚œ a := by forall_elim add_zero_right, a
        have hâ‚â‚â‚â‚ƒ: âˆ€ (nâ‚‚: â„•), âˆ€ (nâ‚ƒ: â„•), (ğŸ¬ +â‚™â‚â‚œ a) =â‚™â‚â‚œ nâ‚‚ âˆ§ nâ‚‚ =â‚™â‚â‚œ nâ‚ƒ â†’ (ğŸ¬ +â‚™â‚â‚œ a) =â‚™â‚â‚œ nâ‚ƒ := by forall_elim eq_trans, (ğŸ¬ +â‚™â‚â‚œ a)
        have hâ‚â‚â‚â‚„: âˆ€ (nâ‚ƒ: â„•), (ğŸ¬ +â‚™â‚â‚œ a) =â‚™â‚â‚œ a âˆ§ a =â‚™â‚â‚œ nâ‚ƒ â†’ (ğŸ¬ +â‚™â‚â‚œ a) =â‚™â‚â‚œ nâ‚ƒ := by forall_elim hâ‚â‚â‚â‚ƒ, a
        have hâ‚â‚â‚â‚…: (ğŸ¬ +â‚™â‚â‚œ a) =â‚™â‚â‚œ a âˆ§ a =â‚™â‚â‚œ (a +â‚™â‚â‚œ ğŸ¬) â†’ (ğŸ¬ +â‚™â‚â‚œ a) =â‚™â‚â‚œ (a +â‚™â‚â‚œ ğŸ¬) := by forall_elim hâ‚â‚â‚â‚„, (a +â‚™â‚â‚œ ğŸ¬)
        have hâ‚â‚â‚â‚†: a =â‚™â‚â‚œ (a +â‚™â‚â‚œ ğŸ¬) := by
          have hâ‚â‚â‚â‚†â‚: âˆ€ (m: â„•), (a +â‚™â‚â‚œ ğŸ¬) =â‚™â‚â‚œ m â†’ m =â‚™â‚â‚œ (a +â‚™â‚â‚œ ğŸ¬) := by forall_elim eq_sym, (a +â‚™â‚â‚œ ğŸ¬)
          have hâ‚â‚â‚â‚†â‚‚: (a +â‚™â‚â‚œ ğŸ¬) =â‚™â‚â‚œ a â†’ a =â‚™â‚â‚œ (a +â‚™â‚â‚œ ğŸ¬) := by forall_elim hâ‚â‚â‚â‚†â‚, a
          modus_ponens hâ‚â‚â‚â‚†â‚‚, hâ‚â‚â‚â‚‚
        have hâ‚â‚â‚â‚‡: (ğŸ¬ +â‚™â‚â‚œ a) =â‚™â‚â‚œ a âˆ§ a =â‚™â‚â‚œ (a +â‚™â‚â‚œ ğŸ¬) := by and_intro hâ‚â‚â‚â‚, hâ‚â‚â‚â‚†
        modus_ponens hâ‚â‚â‚â‚…, hâ‚â‚â‚â‚‡
      have hâ‚â‚â‚‚: âˆ€ (x: â„•), x âˆˆâ‚›â‚‘â‚œ A â†” A x := by forall_elim Sets.mem_def, A
      have hâ‚â‚â‚ƒ: ğŸ¬ âˆˆâ‚›â‚‘â‚œ A â†” A ğŸ¬ := by forall_elim hâ‚â‚â‚‚, ğŸ¬
      have hâ‚â‚â‚„: ğŸ¬ âˆˆâ‚›â‚‘â‚œ A := pcâ‚€.deductive_eq_r2l hâ‚â‚â‚ƒ hâ‚â‚â‚
      iterate hâ‚â‚â‚„
    have hâ‚â‚‚: âˆ€ (n: â„•), n âˆˆâ‚›â‚‘â‚œ A â†’ (ğšœ n) âˆˆâ‚›â‚‘â‚œ A := by forall_intro
      variable(a: â„•)
      assume(hâ‚â‚‚â‚: a âˆˆâ‚›â‚‘â‚œ A)
      have hâ‚â‚‚â‚‚: âˆ€ (x: â„•), x âˆˆâ‚›â‚‘â‚œ A â†” A x := by forall_elim Sets.mem_def, A
      have hâ‚â‚‚â‚ƒ: a âˆˆâ‚›â‚‘â‚œ A â†” A a := by forall_elim hâ‚â‚‚â‚‚, a
      have hâ‚â‚‚â‚„: âˆ€ (m : â„•), (a +â‚™â‚â‚œ m) =â‚™â‚â‚œ (m +â‚™â‚â‚œ a) := pcâ‚€.deductive_eq_l2r hâ‚â‚‚â‚ƒ hâ‚â‚‚â‚
      have hâ‚â‚‚â‚…: âˆ€ (m: â„•), (ğšœ a +â‚™â‚â‚œ m) =â‚™â‚â‚œ ğšœ (a +â‚™â‚â‚œ m) := by forall_elim add_succ_def, a
      have hâ‚â‚‚â‚†: âˆ€ (m: â„•), (ğšœ a +â‚™â‚â‚œ m) =â‚™â‚â‚œ (m +â‚™â‚â‚œ ğšœ a) := by forall_intro
        variable(b: â„•)
        have hâ‚â‚‚â‚†â‚: ğšœ (a +â‚™â‚â‚œ b) =â‚™â‚â‚œ ğšœ (b +â‚™â‚â‚œ a) := by
            have hâ‚â‚‚â‚†â‚‚: (a +â‚™â‚â‚œ b) =â‚™â‚â‚œ (b +â‚™â‚â‚œ a) := by forall_elim hâ‚â‚‚â‚„, b
            have hâ‚â‚‚â‚†â‚ƒ: âˆ€ (m: â„•), ((a +â‚™â‚â‚œ b) =â‚™â‚â‚œ m) â†’ (ğšœ (a +â‚™â‚â‚œ b)) =â‚™â‚â‚œ (ğšœ m) := by forall_elim succ_cong, (a +â‚™â‚â‚œ b)
            have hâ‚â‚‚â‚†â‚„: ((a +â‚™â‚â‚œ b) =â‚™â‚â‚œ (b +â‚™â‚â‚œ a)) â†’ (ğšœ (a +â‚™â‚â‚œ b)) =â‚™â‚â‚œ (ğšœ (b +â‚™â‚â‚œ a)) := by forall_elim hâ‚â‚‚â‚†â‚ƒ, (b +â‚™â‚â‚œ a)
            modus_ponens hâ‚â‚‚â‚†â‚„, hâ‚â‚‚â‚†â‚‚
        have hâ‚â‚‚â‚†â‚‚: (ğšœ a +â‚™â‚â‚œ b) =â‚™â‚â‚œ (b +â‚™â‚â‚œ ğšœ a) := by
          have hâ‚â‚‚â‚†â‚‚â‚‚: (ğšœ a +â‚™â‚â‚œ b) =â‚™â‚â‚œ ğšœ (a +â‚™â‚â‚œ b) := by forall_elim hâ‚â‚‚â‚…, b
          have hâ‚â‚‚â‚†â‚‚â‚„: ğšœ (b +â‚™â‚â‚œ a) =â‚™â‚â‚œ (b +â‚™â‚â‚œ ğšœ a) := by
            have hâ‚â‚‚â‚†â‚‚â‚„â‚: âˆ€ (m: â„•), (b +â‚™â‚â‚œ ğšœ m) =â‚™â‚â‚œ ğšœ (b +â‚™â‚â‚œ m) := by forall_elim add_suc_right, b
            have hâ‚â‚‚â‚†â‚‚â‚„â‚‚: (b +â‚™â‚â‚œ ğšœ a) =â‚™â‚â‚œ ğšœ (b +â‚™â‚â‚œ a) := by forall_elim hâ‚â‚‚â‚†â‚‚â‚„â‚, a
            have hâ‚â‚‚â‚†â‚‚â‚„â‚ƒ: âˆ€ (m: â„•), (b +â‚™â‚â‚œ ğšœ a) =â‚™â‚â‚œ m â†’ m =â‚™â‚â‚œ (b +â‚™â‚â‚œ ğšœ a) := by forall_elim eq_sym, (b +â‚™â‚â‚œ ğšœ a)
            have hâ‚â‚‚â‚†â‚‚â‚„â‚„: (b +â‚™â‚â‚œ ğšœ a) =â‚™â‚â‚œ ğšœ (b +â‚™â‚â‚œ a) â†’ (ğšœ (b +â‚™â‚â‚œ a)) =â‚™â‚â‚œ (b +â‚™â‚â‚œ ğšœ a) := by forall_elim hâ‚â‚‚â‚†â‚‚â‚„â‚ƒ, (ğšœ (b +â‚™â‚â‚œ a))
            modus_ponens hâ‚â‚‚â‚†â‚‚â‚„â‚„, hâ‚â‚‚â‚†â‚‚â‚„â‚‚
          have hâ‚â‚‚â‚†â‚‚â‚…: âˆ€ (nâ‚‚: â„•), âˆ€ (nâ‚ƒ: â„•), (ğšœ a +â‚™â‚â‚œ b) =â‚™â‚â‚œ nâ‚‚ âˆ§ nâ‚‚ =â‚™â‚â‚œ nâ‚ƒ â†’ (ğšœ a +â‚™â‚â‚œ b) =â‚™â‚â‚œ nâ‚ƒ := by forall_elim eq_trans, (ğšœ a +â‚™â‚â‚œ b)
          have hâ‚â‚‚â‚†â‚‚â‚†: âˆ€ (nâ‚ƒ: â„•), (ğšœ a +â‚™â‚â‚œ b) =â‚™â‚â‚œ (ğšœ (a +â‚™â‚â‚œ b)) âˆ§ (ğšœ (a +â‚™â‚â‚œ b)) =â‚™â‚â‚œ nâ‚ƒ â†’ (ğšœ a +â‚™â‚â‚œ b) =â‚™â‚â‚œ nâ‚ƒ := by forall_elim hâ‚â‚‚â‚†â‚‚â‚…, (ğšœ (a +â‚™â‚â‚œ b))
          have hâ‚â‚‚â‚†â‚‚â‚‡: (ğšœ a +â‚™â‚â‚œ b) =â‚™â‚â‚œ (ğšœ (a +â‚™â‚â‚œ b)) âˆ§ (ğšœ (a +â‚™â‚â‚œ b)) =â‚™â‚â‚œ (ğšœ (b +â‚™â‚â‚œ a)) â†’ (ğšœ a +â‚™â‚â‚œ b) =â‚™â‚â‚œ (ğšœ (b +â‚™â‚â‚œ a)) := by forall_elim hâ‚â‚‚â‚†â‚‚â‚†, (ğšœ (b +â‚™â‚â‚œ a))
          have hâ‚â‚‚â‚†â‚‚â‚ˆ: (ğšœ a +â‚™â‚â‚œ b) =â‚™â‚â‚œ ğšœ (a +â‚™â‚â‚œ b) âˆ§ (ğšœ (a +â‚™â‚â‚œ b) =â‚™â‚â‚œ ğšœ (b +â‚™â‚â‚œ a)) := by and_intro hâ‚â‚‚â‚†â‚‚â‚‚, hâ‚â‚‚â‚†â‚
          have hâ‚â‚‚â‚†â‚‚â‚‰: (ğšœ a +â‚™â‚â‚œ b) =â‚™â‚â‚œ ğšœ (b +â‚™â‚â‚œ a) := by modus_ponens hâ‚â‚‚â‚†â‚‚â‚‡, hâ‚â‚‚â‚†â‚‚â‚ˆ
          have hâ‚â‚‚â‚†â‚‚â‚â‚: âˆ€ (nâ‚ƒ: â„•), (ğšœ a +â‚™â‚â‚œ b) =â‚™â‚â‚œ (ğšœ (b +â‚™â‚â‚œ a)) âˆ§ (ğšœ (b +â‚™â‚â‚œ a)) =â‚™â‚â‚œ nâ‚ƒ â†’ (ğšœ a +â‚™â‚â‚œ b) =â‚™â‚â‚œ nâ‚ƒ := by forall_elim hâ‚â‚‚â‚†â‚‚â‚…, (ğšœ (b +â‚™â‚â‚œ a))
          have hâ‚â‚‚â‚†â‚‚â‚â‚‚: (ğšœ a +â‚™â‚â‚œ b) =â‚™â‚â‚œ (ğšœ (b +â‚™â‚â‚œ a)) âˆ§ (ğšœ (b +â‚™â‚â‚œ a)) =â‚™â‚â‚œ (b +â‚™â‚â‚œ ğšœ a) â†’ (ğšœ a +â‚™â‚â‚œ b) =â‚™â‚â‚œ (b +â‚™â‚â‚œ ğšœ a) := by forall_elim hâ‚â‚‚â‚†â‚‚â‚â‚, (b +â‚™â‚â‚œ ğšœ a)
          have hâ‚â‚‚â‚†â‚‚â‚â‚ƒ: (ğšœ a +â‚™â‚â‚œ b) =â‚™â‚â‚œ (ğšœ (b +â‚™â‚â‚œ a)) âˆ§ (ğšœ (b +â‚™â‚â‚œ a)) =â‚™â‚â‚œ (b +â‚™â‚â‚œ ğšœ a) := by and_intro hâ‚â‚‚â‚†â‚‚â‚‰, hâ‚â‚‚â‚†â‚‚â‚„
          modus_ponens hâ‚â‚‚â‚†â‚‚â‚â‚‚, hâ‚â‚‚â‚†â‚‚â‚â‚ƒ
      have hâ‚â‚‚â‚‡: (ğšœ a) âˆˆâ‚›â‚‘â‚œ A â†” A (ğšœ a) := by forall_elim hâ‚â‚‚â‚‚, (ğšœ a)
      have hâ‚â‚‚â‚ˆ: (ğšœ a) âˆˆâ‚›â‚‘â‚œ A := pcâ‚€.deductive_eq_r2l hâ‚â‚‚â‚‡ hâ‚â‚‚â‚†
      iterate hâ‚â‚‚â‚ˆ
    have hâ‚â‚ƒ: (ğŸ¬ âˆˆâ‚›â‚‘â‚œ A) âˆ§ (âˆ€ (n: â„•), n âˆˆâ‚›â‚‘â‚œ A â†’ (ğšœ n) âˆˆâ‚›â‚‘â‚œ A) := by and_intro hâ‚â‚, hâ‚â‚‚
    have hâ‚â‚„: ((ğŸ¬ âˆˆâ‚›â‚‘â‚œ A) âˆ§ (âˆ€ (n: â„•), n âˆˆâ‚›â‚‘â‚œ A â†’ (ğšœ n) âˆˆâ‚›â‚‘â‚œ A)) â†’ (âˆ€ (n: â„•), n âˆˆâ‚›â‚‘â‚œ A) := by forall_elim induction, A
    have hâ‚â‚…: âˆ€ (n: â„•), n âˆˆâ‚›â‚‘â‚œ A := by modus_ponens hâ‚â‚„, hâ‚â‚ƒ
    variable (a: â„•)
    have hâ‚â‚†: a âˆˆâ‚›â‚‘â‚œ A := by forall_elim hâ‚â‚…, a
    have hâ‚â‚‡: âˆ€ (x: â„•), x âˆˆâ‚›â‚‘â‚œ A â†” A x := by forall_elim Sets.mem_def, A
    have hâ‚â‚ˆ: a âˆˆâ‚›â‚‘â‚œ A â†” A a := by forall_elim hâ‚â‚‡, a
    have hâ‚â‚‰: âˆ€ (m : â„•), (a +â‚™â‚â‚œ m) =â‚™â‚â‚œ (m +â‚™â‚â‚œ a) := pcâ‚€.deductive_eq_l2r hâ‚â‚ˆ hâ‚â‚†
    iterate hâ‚â‚‰
  iterate hâ‚
